<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyfrag_plotter.plot.plot_classes &mdash; PyFragPlotter 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=f6245a2f"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PyFragPlotter
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">pyfrag_plot</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyFragPlotter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyfrag_plotter.plot.plot_classes</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyfrag_plotter.plot.plot_classes</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">j</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyfrag_plotter.plot_parameters</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span>

<span class="n">extra_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;orbitalenergy&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="s2">&quot;overlap&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="SoloPlotter"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter">[docs]</a><span class="k">class</span> <span class="nc">SoloPlotter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputfile</span><span class="p">,</span> <span class="n">resultfile</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">systemname</span><span class="p">,</span> <span class="n">irc_coord_info</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">max_plotstep</span><span class="p">):</span>
        <span class="c1"># Init variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">systemname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">irc_coords</span> <span class="o">=</span> <span class="n">irc_coord_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_plotstep</span> <span class="o">=</span> <span class="n">max_plotstep</span>

        <span class="c1"># Init functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_inputfile</span><span class="p">(</span><span class="n">inputfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">resultfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_disp_term</span><span class="p">()</span>

<div class="viewcode-block" id="SoloPlotter.plot"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpath</span><span class="p">,</span> <span class="n">plotparameter</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Plot functions</span>
        <span class="k">if</span> <span class="n">plotparameter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_plotpath</span><span class="p">(</span><span class="n">plotpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_eda_terms</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_asm_terms</span><span class="p">()</span>

            <span class="c1"># Plotting &quot;special keys&quot; like overlap, orbitalenergies &amp; gross populations</span>
            <span class="c1"># ove_key, pop_key, orb_key = self.check_terms()</span>
            <span class="c1"># if ove_key: self.plot_overlaps(self.specialkeys[&#39;ove&#39;])</span>
            <span class="c1"># if pop_key: self.plot_populations(self.specialkeys[&#39;pop&#39;])</span>
            <span class="c1"># if orb_key: self.plot_energygaps(self.specialkeys[&#39;orb&#39;])</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plots succesfully made for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SoloPlotter.create_plotpath"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.create_plotpath">[docs]</a>    <span class="k">def</span> <span class="nf">create_plotpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpath</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes as argument the desired plotpath for the plots</span>
<span class="sd">        If the directory does not exist, it creates one</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">plotpath</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="SoloPlotter.read_inputfile"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.read_inputfile">[docs]</a>    <span class="k">def</span> <span class="nf">read_inputfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes as argument the inputfile for the pyfrag calculation</span>
<span class="sd">        Extracts extra specifications such as orbitalenergy, overlap, population of a certain fragment and MO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_keys</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">old_spec</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">spec_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inputfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
                    <span class="c1"># Replace the frag1 and frag2 strings with the names of the fragments, which are seperated by an underscore</span>
                    <span class="k">if</span> <span class="s2">&quot;frag1&quot;</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                        <span class="n">elements</span><span class="p">[</span><span class="n">elements</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;frag1&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;frag2&quot;</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                        <span class="n">elements</span><span class="p">[</span><span class="n">elements</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;frag2&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># Checks if an element of a line is in the extra_keys list ...</span>
                    <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">extra_keys</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">old_spec</span> <span class="ow">in</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">old_spec</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">old_spec</span><span class="p">:</span>
                            <span class="n">spec_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">spec_counter</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="c1"># ... if so, the dictionary &#39;special_keys&#39; is appended with the special key</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">special_keys</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">spec_counter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">elements</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">special_keys</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">spec_counter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="n">old_spec</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="SoloPlotter.read_data"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.read_data">[docs]</a>    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datafile</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a dictionary with with the keys specifying which data it represents (EDA term, energy, etc.)</span>
<span class="sd">        Takes as argument the absolute path to the pyfrag output file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">datafile</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">datafile</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">datafile</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Determines until which step the data should be processed (eventually plotted)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_plotstep</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_plotstep</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_plotstep</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="c1"># First find to which array the specified bondlength should be compared to, for example a stretch coord of an angle</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">irc_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">header</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="si">}</span><span class="s2"> not in header of pyfrag text file&quot;</span><span class="p">)</span>
            <span class="c1"># Then determine the nearest value using the correct array</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">irc_index</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_plotstep</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_plotstep</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_stationary_point</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Processes the data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">steps</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="c1"># Replaces uninformative headers like &#39;orbitalenergy_1&#39; with for example &#39;orbitalenergy_A_CGeP_33&#39;</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_keys</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">special_keys</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="c1"># Keeps track which keys are changed</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
        <span class="c1"># Makes a dictionary with the results at the peak (maximum of total energy/bond energy)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakdic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">peakstep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_stationary_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="s2">&quot;EnergyTotal&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">array</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakdic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">peakstep</span><span class="p">]</span></div>

        <span class="c1"># for key,value in self.specialkeys.items():</span>
        <span class="c1">#    print(key, value)</span>

        <span class="c1"># for key,value in self.peakdic.items():</span>
        <span class="c1">#    print(key, value)</span>

<div class="viewcode-block" id="SoloPlotter.remove_outliers"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.remove_outliers">[docs]</a>    <span class="k">def</span> <span class="nf">remove_outliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_matrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes outliers in the data (caused by forcing restricted conditions)</span>
<span class="sd">        The threshold is specified in plot_parameters.py and the outlier is removed when</span>
<span class="sd">        its value is higher than the threshold compared to its neighboring values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># check the pyfrag txt file to see with column is the best option</span>
        <span class="n">delete_counter</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># the array of which indices are deleted becomes shorter and thus a correction is needed</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">[:,</span> <span class="n">axis</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="n">delete_counter</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">pp</span><span class="o">.</span><span class="n">outlier_threshold</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">pp</span><span class="o">.</span><span class="n">outlier_threshold</span><span class="p">):</span>
                <span class="n">data_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">delete_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">data_matrix</span></div>

<div class="viewcode-block" id="SoloPlotter.check_disp_term"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.check_disp_term">[docs]</a>    <span class="k">def</span> <span class="nf">check_disp_term</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the dispersion term in the EDA if its contribution is 0 or near 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EDA_keys</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">EDA_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EDA_names</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">EDA_names</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">EDA_keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]))</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EDA_keys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EDA_keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EDA_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EDA_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="SoloPlotter.check_terms"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.check_terms">[docs]</a>    <span class="k">def</span> <span class="nf">check_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if overlaps, orbitalenergies and/or gross populations have been calculated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ove_key</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">pop_key</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">orb_key</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s2">&quot;ove&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">:</span>
            <span class="n">ove_key</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s2">&quot;pop&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">:</span>
            <span class="n">pop_key</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s2">&quot;orb&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">:</span>
            <span class="n">orb_key</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">ove_key</span><span class="p">,</span> <span class="n">pop_key</span><span class="p">,</span> <span class="n">orb_key</span></div>

<div class="viewcode-block" id="SoloPlotter.determine_stationary_point"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.determine_stationary_point">[docs]</a>    <span class="k">def</span> <span class="nf">determine_stationary_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy_array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the step at which a stationary point is reached:</span>
<span class="sd">        either the minimum or maximum of the supplied energy array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pp</span><span class="o">.</span><span class="n">stat_point</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">energy_array</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pp</span><span class="o">.</span><span class="n">stat_point</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">energy_array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;stat_point in plot_parameters.py should be either &#39;min&#39; or &#39;max&#39;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SoloPlotter.get_energygap"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.get_energygap">[docs]</a>    <span class="k">def</span> <span class="nf">get_energygap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the HOMO LUMO gap</span>
<span class="sd">        Takes two keys, present in the datadic, and determines the absolute difference</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;orbitalenergy&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f1</span> <span class="ow">and</span> <span class="s2">&quot;orbitalenergy&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f2</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error HOMO-LUMO gap calculation&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">f2</span><span class="p">])</span> <span class="o">*</span> <span class="n">pp</span><span class="o">.</span><span class="n">har_eV_ratio</span></div>

<div class="viewcode-block" id="SoloPlotter.get_stabilization"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.get_stabilization">[docs]</a>    <span class="k">def</span> <span class="nf">get_stabilization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">overlapkey</span><span class="p">,</span>
        <span class="n">e_key1</span><span class="p">,</span>
        <span class="n">e_key2</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the stabilization S^2/gap for a certain MO pair</span>
<span class="sd">        Important: the MO pair in the overlapkey should correspond to the MO pair of the individual orbitalenergy keys</span>
<span class="sd">        Returns the stabilization in units [S^2 / eV]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_energygap</span><span class="p">(</span><span class="n">e_key1</span><span class="p">,</span> <span class="n">e_key2</span><span class="p">)</span>
        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">overlapkey</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">/</span> <span class="n">gap</span></div>

<div class="viewcode-block" id="SoloPlotter.get_peakinfo"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.get_peakinfo">[docs]</a>    <span class="k">def</span> <span class="nf">get_peakinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dic</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information on the peak step:</span>
<span class="sd">           dic = True: returns the dictionary containing all the results at the peak position</span>
<span class="sd">           dic = False: returns the step at which the energy peak as been reached</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dic</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakdic</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakdic</span><span class="p">[</span><span class="s2">&quot;IRC&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="SoloPlotter.get_systeminfo"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.get_systeminfo">[docs]</a>    <span class="k">def</span> <span class="nf">get_systeminfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name, dictrionary with the data, color and ... of the instance</span>
<span class="sd">        This method is used in the multiplot class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span></div>

<div class="viewcode-block" id="SoloPlotter.get_specialkey"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.get_specialkey">[docs]</a>    <span class="k">def</span> <span class="nf">get_specialkey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary containing the data names of special keys such as &#39;overlap&#39;, &#39;orbitalenergy&#39;, etc.</span>
<span class="sd">        The user can choose which special key will be returned</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="s2">&quot;overlap&quot;</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;ove&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">[</span><span class="s2">&quot;ove&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="s2">&quot;population&quot;</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pop&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">[</span><span class="s2">&quot;pop&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="s2">&quot;orbitalenergy&quot;</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;orb&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span><span class="p">[</span><span class="s2">&quot;orb&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">specialkeys</span></div>

<div class="viewcode-block" id="SoloPlotter.get_eda_keys"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.get_eda_keys">[docs]</a>    <span class="k">def</span> <span class="nf">get_eda_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list containing the EDA keys. This method is necessary because the dispersion term could be removed for this instance</span>
<span class="sd">        This method is used in the multiplot class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">EDA_keys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">EDA_names</span></div>

<div class="viewcode-block" id="SoloPlotter.plot_energygaps"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.plot_energygaps">[docs]</a>    <span class="k">def</span> <span class="nf">plot_energygaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orb_keys</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes as argument the keys which represent the data with the orbital energies</span>
<span class="sd">        Plots the specified energy gaps and saves the figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">orb_keys</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">MO_pair</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">orb_keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]),</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">orb_keys</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">MO_pair</span><span class="p">)</span>
            <span class="n">gap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_energygap</span><span class="p">(</span><span class="n">orb_keys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">orb_keys</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">gap</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">solo_col</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">set_plot_details</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u03B5</span><span class="s2"> / eV&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Energy Gap #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Energy Gap #</span><span class="si">{i}</span><span class="s2">.png&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="SoloPlotter.plot_populations"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.plot_populations">[docs]</a>    <span class="k">def</span> <span class="nf">plot_populations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_keys</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes as argument the keys which represent the population of orbitals</span>
<span class="sd">        Plots the specified populations and saves the figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">color_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">style_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pop_keys</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">color_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">solo_col</span><span class="p">[</span><span class="n">color_counter</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">styles</span><span class="p">[</span><span class="n">style_counter</span><span class="p">])</span>
            <span class="n">style_counter</span> <span class="o">=</span> <span class="n">switch</span><span class="p">(</span><span class="n">style_counter</span><span class="p">)</span>
        <span class="n">set_plot_details</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Gross Population&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Gross Populations of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;GrossPopulations.png&quot;</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],)</span></div>

<div class="viewcode-block" id="SoloPlotter.plot_overlaps"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.plot_overlaps">[docs]</a>    <span class="k">def</span> <span class="nf">plot_overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overlap_keys</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes as argument the keys which represent the overlap between two orbitals</span>
<span class="sd">        Plots the specified overlap(s) and saves the figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">overlap_keys</span><span class="p">):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">solo_col</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">set_plot_details</span><span class="p">(</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Overlap $\itS$&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Overlaps of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Overlaps.png&quot;</span><span class="p">),</span>
            <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="SoloPlotter.plot_eda_terms"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.plot_eda_terms">[docs]</a>    <span class="k">def</span> <span class="nf">plot_eda_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the EDA terms in either a combined graph or in seperate graphs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EDA_keys</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">EDA_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">solo_col</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">set_plot_details</span><span class="p">(</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u0394</span><span class="s2">$\it</span><span class="si">{E}</span><span class="s2">$ / kcal mol$^{-1}$&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;EDA terms of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;EDA.png&quot;</span><span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="SoloPlotter.plot_asm_terms"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.SoloPlotter.plot_asm_terms">[docs]</a>    <span class="k">def</span> <span class="nf">plot_asm_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the ASM terms in a combined graph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">ASM_keys</span><span class="p">[:</span><span class="mi">3</span><span class="p">]):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">datadic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ASM_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">solo_col</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">set_plot_details</span><span class="p">(</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u0394</span><span class="s2">$\it</span><span class="si">{E}</span><span class="s2">$ / kcal mol$^{-1}$&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;ASM terms of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;ASM.png&quot;</span><span class="p">),</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="MultiPlotter"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter">[docs]</a><span class="k">class</span> <span class="nc">MultiPlotter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpath</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span> <span class="n">irc_coord_info</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="n">instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">plotpath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">irc_coords</span> <span class="o">=</span> <span class="n">irc_coord_info</span>

<div class="viewcode-block" id="MultiPlotter.plot"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpolate_coord</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots graphs such as ASM, EDA, overlaps, populations etc. for all systems combined</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">disp</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">orbenergy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_terms</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pp</span><span class="o">.</span><span class="n">vline</span> <span class="ow">and</span> <span class="n">interpolate_coord</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vline</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">interpolate_coord</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vline</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_multiple_asm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_multiple_asm</span><span class="p">(</span><span class="n">plot_extra_strain</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_multiple_eda</span><span class="p">(</span><span class="n">disp_check</span><span class="o">=</span><span class="n">disp</span><span class="p">)</span>

        <span class="c1"># if overlap:</span>
        <span class="c1">#     self.plot_multiple_overlap()</span>
        <span class="c1"># if population:</span>
        <span class="c1">#     self.plot_multiple_population()</span>
        <span class="c1"># if orbenergy:</span>
        <span class="c1">#     self.plot_multiple_energygap()</span>
        <span class="c1"># if orbenergy and population:</span>
        <span class="c1">#     self.plot_multiple_stabilization()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multi plots succesfully made</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.check_terms"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.check_terms">[docs]</a>    <span class="k">def</span> <span class="nf">check_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if certain keys/terms are present in the data and in EDA keys that should be plotted by returning True (&#39;yes&#39;) or False (&#39;no&#39;) for each</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">disp_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">overlap_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">population_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">orbitalenergy_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
            <span class="n">EDA_keys</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">get_eda_keys</span><span class="p">()</span>
            <span class="n">special_keys</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">get_specialkey</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;Disp&quot;</span> <span class="ow">in</span> <span class="n">EDA_keys</span><span class="p">:</span>
                <span class="n">disp_check</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="s2">&quot;ove&quot;</span> <span class="ow">in</span> <span class="n">special_keys</span><span class="p">:</span>
                <span class="n">overlap_check</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="s2">&quot;pop&quot;</span> <span class="ow">in</span> <span class="n">special_keys</span><span class="p">:</span>
                <span class="n">population_check</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="s2">&quot;orb&quot;</span> <span class="ow">in</span> <span class="n">special_keys</span><span class="p">:</span>
                <span class="n">orbitalenergy_check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">disp_check</span><span class="p">,</span> <span class="n">overlap_check</span><span class="p">,</span> <span class="n">population_check</span><span class="p">,</span> <span class="n">orbitalenergy_check</span></div>

<div class="viewcode-block" id="MultiPlotter.get_max_peaklength"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.get_max_peaklength">[docs]</a>    <span class="k">def</span> <span class="nf">get_max_peaklength</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks which system has the highest peak and return the coordinate corresponding to that peak</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">peaks</span> <span class="o">=</span> <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.plot_multiple_asm"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot_multiple_asm">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiple_asm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_extra_strain</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the ASM terms being Ebond, Eint and Estrain</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plot_keys</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">ASM_keys</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;ASM_Combined.png&quot;</span>

        <span class="k">if</span> <span class="n">plot_extra_strain</span><span class="p">:</span>
            <span class="n">plot_keys</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">ASM_strain_keys</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;ASM_Strain.png&quot;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_keys</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
                <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ASM_styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">peakdic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ASM_styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_keys</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">set_plot_details</span><span class="p">(</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u0394</span><span class="s2">$\it</span><span class="si">{E}</span><span class="s2">$ / kcal mol$^{-1}$&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ASM Analysis&quot;</span><span class="p">,</span>
                    <span class="n">vline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vline</span><span class="p">,</span>
                    <span class="n">ylim</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">ASM_ylim</span><span class="p">,</span>
                    <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">),</span>
                    <span class="n">zero_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.plot_multiple_eda"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot_multiple_eda">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiple_eda</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">disp_check</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the EDA terms for each instance in one graph and in seperate graphs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Combined graph</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
            <span class="n">EDA_keys</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_eda_keys</span><span class="p">()</span>
            <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">EDA_keys</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">EDA_styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">peakdic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">EDA_styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="p">)</span>
        <span class="n">set_plot_details</span><span class="p">(</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u0394</span><span class="s2">$\it</span><span class="si">{E}</span><span class="s2">$ / kcal mol$^{-1}$&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;EDA Analysis&quot;</span><span class="p">,</span>
            <span class="n">vline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vline</span><span class="p">,</span>
            <span class="n">zero_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;EDA_Combined.png&quot;</span><span class="p">),</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">EDA_ylim</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Seperated graph for each term</span>
        <span class="k">if</span> <span class="n">disp_check</span><span class="p">:</span>
            <span class="n">EDA_keys</span><span class="p">,</span> <span class="n">EDA_names</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">EDA_keys</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">EDA_names</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">EDA_keys</span><span class="p">,</span> <span class="n">EDA_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_eda_keys</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">EDA_keys</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
                <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">peakdic</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
            <span class="n">set_plot_details</span><span class="p">(</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u0394</span><span class="s2">$\it</span><span class="si">{E}</span><span class="s2">$ / kcal mol$^{-1}$&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;EDA term </span><span class="si">{</span><span class="n">EDA_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">vline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vline</span><span class="p">,</span>
                <span class="n">zero_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;EDA_</span><span class="si">{</span><span class="n">EDA_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">),</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.plot_multiple_overlap"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot_multiple_overlap">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiple_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the overlap for each instance for the same MO pair in seperate graphs</span>
<span class="sd">        Note: it assumes that the number of MO pairs is the same for each instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">overlap_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_specialkey</span><span class="p">(</span><span class="s2">&quot;ove&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">overlap_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
                <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">overlap_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">overlap_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">peakdic</span><span class="p">[</span><span class="n">overlap_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span>
                <span class="p">)</span>
            <span class="n">set_plot_details</span><span class="p">(</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Overlap $\itS$&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Overlap&quot;</span><span class="p">,</span>
                <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Overlap_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">),</span>
                <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.plot_multiple_population"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot_multiple_population">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiple_population</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the gross populations for each instance for the same MO pair in seperate graphs</span>
<span class="sd">        Note: it assumes that the number of MO pairs is the same for each instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">population_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_specialkey</span><span class="p">(</span><span class="s2">&quot;pop&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">population_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
                <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">population_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]),</span>
                    <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">population_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]),</span>
                <span class="p">]</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">population_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">styles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">population_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">styles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">peakdic</span><span class="p">[</span><span class="n">population_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span>
                <span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                    <span class="n">peakdic</span><span class="p">[</span><span class="n">population_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">set_plot_details</span><span class="p">(</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Gross Population&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gross populations&quot;</span><span class="p">,</span>
                <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Population_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">),</span>
                <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.plot_multiple_energygap"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot_multiple_energygap">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiple_energygap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the energy gap for each instance for the same MO pair in seperate graphs</span>
<span class="sd">        Note: it assumes that the number of MO pairs is the same for each instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">energy_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_specialkey</span><span class="p">(</span><span class="s2">&quot;orb&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">energy_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
                <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
                <span class="n">gap</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_energygap</span><span class="p">(</span><span class="n">energy_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">energy_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">MO_pair</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">energy_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]),</span>
                    <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">energy_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]),</span>
                <span class="p">]</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">gap</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">MO_pair</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">gap</span><span class="p">[</span><span class="n">peakdic</span><span class="p">[</span><span class="s2">&quot;IRC&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span>
                <span class="p">)</span>
            <span class="n">set_plot_details</span><span class="p">(</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u03B5</span><span class="s2"> / eV&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Energy gaps&quot;</span><span class="p">,</span>
                <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;EnergyGap_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">),</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MultiPlotter.plot_multiple_stabilization"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.MultiPlotter.plot_multiple_stabilization">[docs]</a>    <span class="k">def</span> <span class="nf">plot_multiple_stabilization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the stabilization (S^2/gap) of a certain MOpair for each instance</span>
<span class="sd">        Note: it assumes that the number of MO pairs is the same for each instance and that the overlapkey represent the same</span>
<span class="sd">        MO pair as the orbital energy keys</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">energy_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_specialkey</span><span class="p">(</span><span class="s2">&quot;orb&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">]</span>
        <span class="n">overlap_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">get_specialkey</span><span class="p">(</span><span class="s2">&quot;ove&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">]</span>
        <span class="n">e_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">energy_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_systeminfo</span><span class="p">()</span>
                <span class="n">peakdic</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_peakinfo</span><span class="p">()</span>
                <span class="n">stabilization</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_stabilization</span><span class="p">(</span>
                    <span class="n">overlap_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">energy_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">e_counter</span><span class="p">],</span>
                    <span class="n">energy_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">e_counter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">MOpair</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">overlap_keys</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span> <span class="n">stabilization</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">MOpair</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">peakdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">irc_coord</span><span class="p">],</span>
                    <span class="n">stabilization</span><span class="p">[</span><span class="n">peakdic</span><span class="p">[</span><span class="s2">&quot;IRC&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">set_plot_details</span><span class="p">(</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$\itS$ / </span><span class="se">\u03B5</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Stabilizations&quot;</span><span class="p">,</span>
                <span class="n">savefig</span><span class="o">=</span><span class="n">j</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Stabilization_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">e_counter</span> <span class="o">+=</span> <span class="mi">2</span></div></div>


<span class="c1"># ################# Functions ###################</span>

<div class="viewcode-block" id="switch"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.switch">[docs]</a><span class="k">def</span> <span class="nf">switch</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Acts as a switch by returning 1 when the value is 0 and vice versa</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="set_plot_details"><a class="viewcode-back" href="../../../pyfrag_plotter.plot.html#pyfrag_plotter.plot.plot_classes.set_plot_details">[docs]</a><span class="k">def</span> <span class="nf">set_plot_details</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">savefig</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">clear</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ylim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">zero_line</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that specifies plot options for making a shorter and cleaner code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pyfrag_plotter.main</span> <span class="kn">import</span> <span class="n">irc_coord</span><span class="p">,</span> <span class="n">irc_coords</span>  <span class="c1"># should be removed. This import is horrible and denotes a bad design (terrible coupling)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="c1"># Plot labels</span>
    <span class="k">if</span> <span class="n">xlabel</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">irc_coords</span><span class="p">[</span><span class="n">irc_coord</span><span class="p">]</span><span class="si">}</span><span class="s2"> / </span><span class="se">\u00c5</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ylabel</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="c1"># Specfies the y limits</span>
    <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Plot x limits</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pp</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Reverses the plot direction by reversing the x-axis</span>
    <span class="k">if</span> <span class="n">irc_coord</span> <span class="o">==</span> <span class="s2">&quot;bondlength_2&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Draws a vertical line at the specified point</span>
    <span class="k">if</span> <span class="n">vline</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
            <span class="n">vline</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;grey&quot;</span><span class="p">],</span>
            <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Draws a horizontal line at y=0 (indicating the &#39;zero line&#39;)</span>
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;grey&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="c1"># Axes adjustments: tick markers and number of ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Removes the top en right border of the graph</span>
    <span class="n">right_side</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
    <span class="n">top_side</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
    <span class="n">right_side</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">top_side</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Makes the x and y axis wider</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Fixes the large padding between the axes and the labels of the axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="c1"># Adds more spacing between ticks and the labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Plots the legend at the right side of the plot</span>
    <span class="c1"># ax.legend(bbox_to_anchor=(0,1.02,1,0.2), loc=&quot;lower left&quot;, mode=&quot;expand&quot;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Plots the title</span>
    <span class="c1"># plt.title(title,pad=10)</span>

    <span class="c1"># Saves the figure in standard .png format.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savefig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

    <span class="c1"># Clears the plot if specified</span>
    <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, SiebeLeDe.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>